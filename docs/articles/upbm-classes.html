<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>upbm: Class Details • upbm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="upbm: Class Details">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">upbm</a>
        <span class="version label label-info" data-toggle="tooltip" data-placement="bottom" title="GitHub pre-release">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/upbm-quickstart.html">Quick Start</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">General</li>
    <li>
      <a href="../articles/upbm-quickstart.html">Quickstart Guide</a>
    </li>
    <li>
      <a href="../articles/upbm-classes.html">PBM Class Details</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Analysis</li>
    <li>
      <a href="../articles/analysis-preprocessing.html">Sample Pre-Processing</a>
    </li>
    <li>
      <a href="../articles/analysis-summarization.html">Probe and K-mer Summarization</a>
    </li>
    <li>
      <a href="../articles/analysis-inference.html">K-mer-Level Inference</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Other</li>
    <li>
      <a href="../articles/other-qcplots.html">Quality Control Plots</a>
    </li>
    <li>
      <a href="../articles/other-tidydata.html">Tidy PBM Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/pkimes/upbm">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>upbm: Class Details</h1>
                        <h4 class="author">Patrick K. Kimes</h4>
            
            <h4 class="date">11 February 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/pkimes/upbm/blob/master/vignettes/upbm-classes.Rmd"><code>vignettes/upbm-classes.Rmd</code></a></small>
      <div class="hidden name"><code>upbm-classes.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>For an introduction to the <em>upbm</em> package, please see the quick start vignette (<code><a href="../articles/upbm-quickstart.html">vignette("upbm-quickstart")</a></code>). Here, we provide details on the two classes introduced in the package, <em>PBMDesign</em> and <em>PBMExperiment</em>. The <em>PBMDesign</em> class acts as a container for protein binding microarray (PBM) design information, while the <em>PBMExperiment</em> class serves as the container for PBM experimental data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"upbm"</span>))</span></code></pre></div>
<p><em>PBMDesign</em> objects for standard universial PBM (uPBM) designs are included in the <em>upbmAux</em> package. Additionally, example <em>PBMExperiment</em> objects are included in the <em>upbmData</em> package containing data from uPBM experiments performed using the HOXC9 transcription factor. We use these objects to help illustrate the simple structure of each class.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"upbmAux"</span>))</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"upbmData"</span>))</span></code></pre></div>
</div>
<div id="pbmdesign" class="section level1">
<h1 class="hasAnchor">
<a href="#pbmdesign" class="anchor"></a>PBMDesign</h1>
<p>The <em>PBMDesign</em> class is used to organize the probe information for PBM experiments. <em>PBMDesign</em> objects are composed of 3 components (<em>slots</em>):</p>
<ul>
<li>
<code>design</code>: a data.frame of probe IDs, sequences, and other metadata,</li>
<li>
<code>probeFilter</code>: an optional list of filtering rules to distinguish signal probes from control spots,</li>
<li>
<code>probeTrim</code>: an optional pair of integers specifying the start and end of the probe sequences to use for analysis.</li>
</ul>
<p>We can take a look at the <code>pbm_8x60k_v1</code> design object from the <em>upbmAux</em> package to get a better sense of these components.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(pbm_8x60k_v1, <span class="dt">package =</span> <span class="st">"upbmAux"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>pbm_8x60k_v1</span></code></pre></div>
<pre><code>## class: PBMDesign
## design dim: 62976 4
## design colnames(4): Column Row probeID Sequence
## probeFilter names(1): probeID
## probeTrim: 1 36</code></pre>
<p>From the object description, we can see that the design contains 62976 rows and 4 columns. Each row is a probe in the PBM array. Two columns, <code>"probeID"</code> and <code>"Sequence"</code> <strong>must</strong> be defined for the object to be a valid <em>PBMDesign</em>. The other two columns, <code>"Row"</code> and <code>"Column"</code> are optional information which are needed to perform spatial adjustment with <code><a href="../reference/spatiallyAdjust.html">upbm::spatiallyAdjust</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">design</span>(pbm_8x60k_v1))</span></code></pre></div>
<pre><code>##   Column Row              probeID
## 1      1   1      GE_BrightCorner
## 2      2   1      GE_BrightCorner
## 3      3   1           DarkCorner
## 4      4   1           DarkCorner
## 5      5   1 Cbf_5b_Hi_n359_o2_r1
## 6      6   1      dBr_14334_Jan07
##                                                       Sequence
## 1                                                         #N/A
## 2                                                         #N/A
## 3                                                         #N/A
## 4                                                         #N/A
## 5 GAAGCTATTCAGATCGACGTGACATGTATATAGTAGGTCTGTGTTCCGTTGTCCGTGCTG
## 6 GGTGTGAGTCCATTTCGTCAAACCAACGCAACAGGTGTCTGTGTTCCGTTGTCCGTGCTG</code></pre>
<p>In addition to dsDNA probes which measure protein binding, PBMs typically include control probes designed by Agilent or the user. These probes should be excluded for certain normalization and downstream analysis steps (e.g. Cy3 normalization and spatial adjustment).</p>
<p>The <code>probeFilter</code> slot is a list of functions which are used to distinguish target probes from control probes. The list must be named with names matching columns in the design shown above. We can get and set the <code>probeFilter</code> slot by calling <code><a href="../reference/PBMclass-accessors.html">upbm::probeFilter</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw"><a href="../reference/PBMclass-accessors.html">probeFilter</a></span>(pbm_8x60k_v1))</span></code></pre></div>
<pre><code>## [1] "probeID"</code></pre>
<p>Here, the <em>PBMDesign</em> object includes a single probe filtering rule associated with the <code>"probeID"</code> column.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="../reference/PBMclass-accessors.html">probeFilter</a></span>(pbm_8x60k_v1)<span class="op">$</span>probeID</span></code></pre></div>
<pre><code>## function(x) { grepl("^dBr", x) }
## &lt;bytecode: 0x7fe367bb36f0&gt;</code></pre>
<p>The rule must be a function that takes the specified column (<code>"probeID"</code>) as input and returns a logical vector of the same length. Only rows which return <code>TRUE</code> for all rules are kept for downstream analysis. In the <code>pbm_8x60k_v1</code> design, the single filter checks the probe IDs and returns <code>TRUE</code> for the subset prefixed with <code>dBr_</code>, corresponding to the subset of de Bruijn sequence probes on the array. Filtering can be performed using <code><a href="../reference/pbmFilterProbes.html">upbm::pbmFilterProbes</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>pbm_8x60k_filtered &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pbmFilterProbes.html">pbmFilterProbes</a></span>(pbm_8x60k_v1)</span>
<span id="cb11-2"><a href="#cb11-2"></a>pbm_8x60k_filtered</span></code></pre></div>
<pre><code>## class: PBMDesign
## design dim: 41944 4
## design colnames(4): Column Row probeID Sequence
## probeFilter names(0): 
## probeTrim: 1 36</code></pre>
<p>Notice that the returned <em>PBMDesign</em> has fewer probes than the original design. We can explicitly verify that this smaller number of probes matches the number of probes containing the <code>dBr</code> prefix in the <code>"probeID"</code> column.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"^dBr"</span>, <span class="kw">design</span>(pbm_8x60k_v1)<span class="op">$</span>probeID))</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
## 21032 41944</code></pre>
<p>After filtering has been performed, the <code>probeFilter</code> slot of the returned <em>PBMDesign</em> is cleared to prevent iterative application of the filtering critera.</p>
<p>Finally, the <code>probeTrim</code> slot is an optional numeric vector of length 2. Again, this can be accessed and set using the <code><a href="../reference/PBMclass-accessors.html">upbm::probeTrim</a></code> function.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw"><a href="../reference/PBMclass-accessors.html">probeTrim</a></span>(pbm_8x60k_filtered)</span></code></pre></div>
<pre><code>## [1]  1 36</code></pre>
<p>Revisiting the design of the probes, notice that the probe sequences all end in a common 24nt primer sequence.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">design</span>(pbm_8x60k_filtered)<span class="op">$</span>Sequence)</span></code></pre></div>
<pre><code>## [1] "GGTGTGAGTCCATTTCGTCAAACCAACGCAACAGGTGTCTGTGTTCCGTTGTCCGTGCTG"
## [2] "CAGTCTAAGTTTTCGGATTACCATTAGAAATTGATGGTCTGTGTTCCGTTGTCCGTGCTG"
## [3] "CTTTTTAAAGACCTAGGAATCATTGCATTCTTATTGGTCTGTGTTCCGTTGTCCGTGCTG"
## [4] "CAGCTACGGAAGAGTAAAGGTTGTCGAAGCCGTGCAGTCTGTGTTCCGTTGTCCGTGCTG"
## [5] "GCTTCGAACGTGGGCGATGGAACAAGTCGCAGTCATGTCTGTGTTCCGTTGTCCGTGCTG"
## [6] "CGCCCGTGGTAACAGTTACGAAAATTACATGCGAAAGTCTGTGTTCCGTTGTCCGTGCTG"</code></pre>
<p>The <code>probeTrim</code> slot specifies the start and end positions in the sequences that should be kept to map K-mers to probes. By default, this is set to <code>(1, 36)</code> in the uPBM designs in <em>upbmAux</em> to exclude the common 24nt primer sequence at the end of all probes. While the values may be modified to include some or all of the primer sequence, this has not been extensively evaluated. Probe trimming can be performed using <code><a href="../reference/pbmTrimProbes.html">upbm::pbmTrimProbes</a></code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>pbm_8x60k_trimmed &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pbmTrimProbes.html">pbmTrimProbes</a></span>(pbm_8x60k_filtered)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">design</span>(pbm_8x60k_trimmed))</span></code></pre></div>
<pre><code>##    Column Row         probeID                             Sequence
## 6       6   1 dBr_14334_Jan07 GGTGTGAGTCCATTTCGTCAAACCAACGCAACAGGT
## 7       7   1 dBr_06208_Jan07 CAGTCTAAGTTTTCGGATTACCATTAGAAATTGATG
## 8       8   1 dBr_39317_Jan07 CTTTTTAAAGACCTAGGAATCATTGCATTCTTATTG
## 9       9   1 dBr_06987_Jan07 CAGCTACGGAAGAGTAAAGGTTGTCGAAGCCGTGCA
## 10     10   1 dBr_05074_Jan07 GCTTCGAACGTGGGCGATGGAACAAGTCGCAGTCAT
## 15     15   1 dBr_16182_Jan07 CGCCCGTGGTAACAGTTACGAAAATTACATGCGAAA</code></pre>
<div id="modifying-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#modifying-objects" class="anchor"></a>Modifying Objects</h2>
<p>All of the slots described above can be modified or updated. For example, we can add an additional (redundant) rule to the <code>probeFilter</code> list of the example <em>PBMDesign</em>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw"><a href="../reference/PBMclass-accessors.html">probeFilter</a></span>(pbm_8x60k_v1) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="../reference/PBMclass-accessors.html">probeFilter</a></span>(pbm_8x60k_v1),</span>
<span id="cb21-2"><a href="#cb21-2"></a>                               <span class="dt">Sequence =</span> <span class="cf">function</span>(x) { x <span class="op">!=</span><span class="st"> "#N/A"</span> })</span></code></pre></div>
<p>We can also easily change the trimming boundaries.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw"><a href="../reference/PBMclass-accessors.html">probeTrim</a></span>(pbm_8x60k_filtered) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">50</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>pbm_8x60k_filtered</span></code></pre></div>
<pre><code>## class: PBMDesign
## design dim: 41944 4
## design colnames(4): Column Row probeID Sequence
## probeFilter names(0): 
## probeTrim: 1 50</code></pre>
</div>
<div id="new-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#new-objects" class="anchor"></a>New Objects</h2>
<p>A new <em>PBMDesign</em> object can be created by passing a data.frame of probe designs to the <code><a href="../reference/PBMDesign.html">upbm::PBMDesign</a></code> constructor. As stated above, at minimum, the data.frame must contain two columns, <code>"probeID"</code> and <code>"Sequence"</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>new_design &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">probeID =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>],</span>
<span id="cb24-2"><a href="#cb24-2"></a>                         <span class="dt">Sequence =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"AAA"</span>, <span class="dv">3</span>))</span>
<span id="cb24-3"><a href="#cb24-3"></a>pbmDesign &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PBMDesign.html">PBMDesign</a></span>(new_design)</span>
<span id="cb24-4"><a href="#cb24-4"></a>pbmDesign</span></code></pre></div>
<pre><code>## class: PBMDesign
## design dim: 3 2
## design colnames(2): probeID Sequence
## probeFilter names(0): 
## probeTrim:</code></pre>
<p>The <code>probeFilter</code> and <code>probeTrim</code> slots can also be specified directly to the <code><a href="../reference/PBMDesign.html">upbm::PBMDesign</a></code> constructor or modified after constructing the <em>PBMDesign</em> object, as shown above.</p>
</div>
</div>
<div id="pbmexperiment" class="section level1">
<h1 class="hasAnchor">
<a href="#pbmexperiment" class="anchor"></a>PBMExperiment</h1>
<p>Probe-level PBM data is stored using the <em>PBMExperiment</em> class, an extension of the <a href="https://bioconductor.org/packages/release/bioc/html/SummarizedExperiment.html"><em>SummarizedExperiment</em></a> class with additional slots to support working with <em>PBMDesign</em> objects.</p>
<p>An example <em>PBMExperiment</em> object containing data from a series of HOXC9 experiments is included in the <em>upbmData</em> package. We will only look at the <em>PBMExperiment</em> containing Alexa488 scans. However, the probe-level data from Cy3 scans are similarly stored and included as a separate <em>PBMExperiment</em> object in the package.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(hoxc9alexa, <span class="dt">package =</span> <span class="st">"upbmData"</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>hoxc9alexa</span></code></pre></div>
<pre><code>## class: PBMExperiment 
## dim: 62976 30 
## metadata(0):
## assays(2): fore back
## rownames: NULL
## rowData names(4): Column Row probeID Sequence
## colnames(30): s1 s2 ... s35 s36
## colData names(10): date version ... condition id_idx
## probeCols(4): Column Row probeID Sequence
## probeFilter names(1): probeID
## probeTrim: 1 36</code></pre>
<p>A <em>SummarizedExperiment</em> object is made up of three parts: <strong>1.</strong> assays (primary data, e.g. probe intensities), <strong>2.</strong> column metadata, and <strong>3.</strong> row metadata. Here, rows correspond to probes and columns correspond to scans. For more details on the <em>SummarizedExperiment</em> class, see the corresponding package <a href="https://bioconductor.org/packages/release/bioc/vignettes/SummarizedExperiment/inst/doc/SummarizedExperiment.html">vignette</a>.</p>
<p>In addition to these three components, <em>PBMExperiment</em> objects also include <code>probeFilter</code>, <code>probeTrim</code> and <code>probeCols</code> slots. The <code>probeFilter</code> and <code>probeTrim</code> slots of the <em>PBMExperiment</em> class are identical to the slots described above as part of the <em>PBMDesign</em> class. The final <code>probeCols</code> slot is a character vector specifying the columns in the row metadata corresponding to the <code>design</code> of a <em>PBMDesign</em> object. Rather than storing the <code>design</code> as a separate slot in <em>PBMExperiment</em> objects, the design is kept in the row metadata and the corresponding columns are recorded in <code>probeCols</code>.</p>
<p>As with <em>PBMDesign</em> objects, these slots can be both accessed and modified. The <code>hoxc9alexa</code> object was constructed with the <code>pbm_8x60k_v1</code> probe design introduced above. We can see that the <code>probeTrim</code> and <code>probeFilter</code> values match what we saw above.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw"><a href="../reference/PBMclass-accessors.html">probeFilter</a></span>(hoxc9alexa)</span></code></pre></div>
<pre><code>## $probeID
## function(x) { grepl("^dBr", x) }
## &lt;bytecode: 0x7fe3717f4078&gt;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw"><a href="../reference/PBMclass-accessors.html">probeTrim</a></span>(hoxc9alexa)</span></code></pre></div>
<pre><code>## [1]  1 36</code></pre>
<p>Additionally, we can see that the <code>probeCols</code> columns of the row metadata match the <code>design</code> slot of <code>pbm_8x60k_v1</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw"><a href="../reference/PBMclass-accessors.html">probeCols</a></span>(hoxc9alexa)</span></code></pre></div>
<pre><code>## [1] "Column"   "Row"      "probeID"  "Sequence"</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">rowData</span>(hoxc9alexa)[, <span class="kw"><a href="../reference/PBMclass-accessors.html">probeCols</a></span>(hoxc9alexa)])</span></code></pre></div>
<pre><code>## DataFrame with 6 rows and 4 columns
##      Column       Row              probeID
##   &lt;integer&gt; &lt;integer&gt;          &lt;character&gt;
## 1         1         1      GE_BrightCorner
## 2         2         1      GE_BrightCorner
## 3         3         1           DarkCorner
## 4         4         1           DarkCorner
## 5         5         1 Cbf_5b_Hi_n359_o2_r1
## 6         6         1      dBr_14334_Jan07
##                                                       Sequence
##                                                    &lt;character&gt;
## 1                                                         #N/A
## 2                                                         #N/A
## 3                                                         #N/A
## 4                                                         #N/A
## 5 GAAGCTATTCAGATCGACGTGACATGTATATAGTAGGTCTGTGTTCCGTTGTCCGTGCTG
## 6 GGTGTGAGTCCATTTCGTCAAACCAACGCAACAGGTGTCTGTGTTCCGTTGTCCGTGCTG</code></pre>
<p>Finally, the corresponding <em>PBMDesign</em> object of a <em>PBMExperiment</em> can be extracted by passing the <em>PBMExperiment</em> object to <code><a href="../reference/PBMDesign.html">upbm::PBMDesign</a></code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw"><a href="../reference/PBMDesign.html">PBMDesign</a></span>(hoxc9alexa)</span></code></pre></div>
<pre><code>## class: PBMDesign
## design dim: 62976 4
## design colnames(4): Column Row probeID Sequence
## probeFilter names(1): probeID
## probeTrim: 1 36</code></pre>
<p>We can check that this is identical to the <em>PBMDesign</em> from above.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="kw"><a href="../reference/PBMDesign.html">PBMDesign</a></span>(hoxc9alexa), pbm_8x60k_v1)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>The <em>PBMDesign</em> associated values can be quickly modified or added using the associated setter function.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw"><a href="../reference/PBMDesign.html">PBMDesign</a></span>(hoxc9alexa) &lt;-<span class="st"> </span>pbm_8x60k_v1</span></code></pre></div>
<p>This can be useful when the design information needs to be added after the <em>PBMExperiment</em> object has been created. However, this should be performed with caution as all prior design associated values will be overwritten.</p>
<p>As with <em>PBMDesign</em>, calls to <code><a href="../reference/pbmFilterProbes.html">upbm::pbmFilterProbes</a></code> and <code><a href="../reference/pbmTrimProbes.html">upbm::pbmTrimProbes</a></code> can be used to filter and trim probes in the <em>PBMExperiment</em> object.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw"><a href="../reference/pbmFilterProbes.html">pbmFilterProbes</a></span>(hoxc9alexa)</span></code></pre></div>
<pre><code>## class: PBMExperiment 
## dim: 41944 30 
## metadata(0):
## assays(2): fore back
## rownames: NULL
## rowData names(4): Column Row probeID Sequence
## colnames(30): s1 s2 ... s35 s36
## colData names(10): date version ... condition id_idx
## probeCols(4): Column Row probeID Sequence
## probeFilter names(0): 
## probeTrim: 1 36</code></pre>
<p>It is also important to note that whenever <code><a href="https://rdrr.io/pkg/broom/man/reexports.html">broom::tidy</a></code> is called to convert assay data to a tidy format, <code><a href="../reference/pbmFilterProbes.html">upbm::pbmFilterProbes</a></code> and <code><a href="../reference/pbmTrimProbes.html">upbm::pbmTrimProbes</a></code> run unless <code>process = FALSE</code> is specified.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(broom<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/broom/man/reexports.html">tidy</a></span>(hoxc9alexa))</span></code></pre></div>
<pre><code>## [1] 41944</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(broom<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/broom/man/reexports.html">tidy</a></span>(hoxc9alexa, <span class="dt">process =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<pre><code>## [1] 62976</code></pre>
<div id="gpr2pbmexperiment" class="section level2">
<h2 class="hasAnchor">
<a href="#gpr2pbmexperiment" class="anchor"></a>gpr2PBMExperiment</h2>
<p>The easiest way to create a new <em>PBMExperiment</em> object is by reading scan data from GPR files using <code><a href="../reference/gpr2PBMExperiment.html">upbm::gpr2PBMExperiment</a></code>. Given a table of GPR file metadata, including paths to the files, the function will return the parsed GPR data as a <em>PBMExperiment</em> object.</p>
<p>In the case of the example dataset, the table used to read the GPR files is also included in the <em>upbmData</em> package.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(hoxc9table, <span class="dt">package =</span> <span class="st">"upbmData"</span>)</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(hoxc9table, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 11
##   gpr     date version    id reuse type    pmt   idx target condition
##   &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 ./PB… 170606 v14       226     1 Alexa   400     2 HOXC9  HOXC9-REF
## 2 ./PB… 170606 v14       226     1 Alexa   400     3 HOXC9  HOXC9-R1…
## 3 ./PB… 170606 v14       226     1 Alexa   400     6 HOXC9  HOXC9-K1…
## 4 ./PB… 170606 v14       226     1 Alexa   450     2 HOXC9  HOXC9-REF
## 5 ./PB… 170606 v14       226     1 Alexa   450     3 HOXC9  HOXC9-R1…
## # … with 1 more variable: id_idx &lt;chr&gt;</code></pre>
<p>At a minimum, the full path to each GPR file <strong>must</strong> be specified in a column named <code>gpr</code>. The data.frame should also include any relevant metadata about the scan and sample (e.g. scan parameters or properties of the assayed protein).</p>
<p>Both Alexa488 and Cy3 scans for the example dataset in the <em>upbmData</em> package are provided in <code>hoxc9table</code>. We will subset to just the Alexa488 scans.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>hoxc9table_alexa &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(hoxc9table, type <span class="op">==</span><span class="st"> "Alexa"</span>)</span></code></pre></div>
<p>In addition to the sample table the corresponding <em>PBMDesign</em> should also be specified when calling <code><a href="../reference/gpr2PBMExperiment.html">upbm::gpr2PBMExperiment</a></code>. While not run here (since raw GPR files are not included with the package), the following call was made to generate the <em>PBMExperiment</em> object included in the <em>upbmData</em> package.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>hoxc9alexa &lt;-<span class="st"> </span><span class="kw"><a href="../reference/gpr2PBMExperiment.html">gpr2PBMExperiment</a></span>(<span class="dt">scans =</span> hoxc9table_alexa,</span>
<span id="cb50-2"><a href="#cb50-2"></a>                                <span class="dt">probes =</span> pbm_8x60k_v1)</span></code></pre></div>
<p>We can see that metadata included in the sample table are stored in the column metadata of the returned <em>PBMExperiment</em> object.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">colData</span>(hoxc9alexa)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, ]</span></code></pre></div>
<pre><code>## DataFrame with 5 rows and 10 columns
##         date     version        id     reuse        type       pmt
##    &lt;numeric&gt; &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;character&gt; &lt;numeric&gt;
## s1    170606         v14       226         1       Alexa       400
## s2    170606         v14       226         1       Alexa       400
## s3    170606         v14       226         1       Alexa       400
## s4    170606         v14       226         1       Alexa       450
## s5    170606         v14       226         1       Alexa       450
##          idx      target   condition      id_idx
##    &lt;numeric&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt;
## s1         2       HOXC9   HOXC9-REF      226_i2
## s2         3       HOXC9 HOXC9-R193K      226_i3
## s3         6       HOXC9 HOXC9-K195R      226_i6
## s4         2       HOXC9   HOXC9-REF      226_i2
## s5         3       HOXC9 HOXC9-R193K      226_i3</code></pre>
<p>For <em>PBMExperiment</em> objects created from GPR files, probe-level foreground intensities are stored in the <code>"fore"</code> assay. By default, (but optionally) a second assay, <code>"back"</code> (background) is also read in from the GPRs with the background intensities for each probe and sample.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">assay</span>(hoxc9alexa, <span class="st">"fore"</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>## DataFrame with 5 rows and 5 columns
##          s1        s2        s3        s4        s5
##   &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
## 1      4446      2191      2209      9780      4681
## 2      4057      1978      2041      8967      4297
## 3      5326      3443      4059     11924      7476
## 4      5686      3410      4012     12573      7458
## 5      4401      3444      2353      9943      7499</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">assay</span>(hoxc9alexa, <span class="st">"back"</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>## DataFrame with 5 rows and 5 columns
##          s1        s2        s3        s4        s5
##   &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
## 1       197        76        65       405       132
## 2       169        76        58       324       134
## 3       161        76        63       324       136
## 4       172        83        85       354       141
## 5       210       100        92       430       177</code></pre>
</div>
<div id="new-objects-1" class="section level2">
<h2 class="hasAnchor">
<a href="#new-objects-1" class="anchor"></a>New Objects</h2>
<p>Alternatively, a new <em>PBMExperiment</em> object can be constructed from existing <em>SummarizedExperiment</em> and <em>PBMDesign</em> objects. To demonstrate this, we can coerce <code>hoxc9alexa</code> to a <em>SummarizedExperiment</em> object, stripping away all <em>PBMExperiment</em>-specific information.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>se &lt;-<span class="st"> </span><span class="kw">as</span>(hoxc9alexa, <span class="st">"SummarizedExperiment"</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a>se</span></code></pre></div>
<pre><code>## class: SummarizedExperiment 
## dim: 62976 30 
## metadata(0):
## assays(2): fore back
## rownames: NULL
## rowData names(4): Column Row probeID Sequence
## colnames(30): s1 s2 ... s35 s36
## colData names(10): date version ... condition id_idx</code></pre>
<p>Notice that the probe annotations are still kept in the row metadata. We can additionally remove this if we would like.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">rowData</span>(se) &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>se</span></code></pre></div>
<pre><code>## class: SummarizedExperiment 
## dim: 62976 30 
## metadata(0):
## assays(2): fore back
## rownames: NULL
## rowData names(0):
## colnames(30): s1 s2 ... s35 s36
## colData names(10): date version ... condition id_idx</code></pre>
<p>With the <em>SummarizedExperiment</em> object, we can now create a new <em>PBMExperiment</em> object using the <code><a href="../reference/PBMExperiment.html">PBMExperiment(..)</a></code> constructor. As with <code><a href="../reference/gpr2PBMExperiment.html">gpr2PBMExperiment(..)</a></code>, a <em>PBMDesign</em> can be specified as an optional parameter.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="kw"><a href="../reference/PBMExperiment.html">PBMExperiment</a></span>(se)</span></code></pre></div>
<pre><code>## class: PBMExperiment 
## dim: 62976 30 
## metadata(0):
## assays(2): fore back
## rownames: NULL
## rowData names(2): Sequence probeID
## colnames(30): s1 s2 ... s35 s36
## colData names(10): date version ... condition id_idx
## probeCols(2): Sequence probeID
## probeFilter names(0): 
## probeTrim:</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw"><a href="../reference/PBMExperiment.html">PBMExperiment</a></span>(se, <span class="dt">pbmDesign =</span> pbm_8x60k_v1)</span></code></pre></div>
<pre><code>## class: PBMExperiment 
## dim: 62976 30 
## metadata(0):
## assays(2): fore back
## rownames: NULL
## rowData names(4): Column Row probeID Sequence
## colnames(30): s1 s2 ... s35 s36
## colData names(10): date version ... condition id_idx
## probeCols(4): Column Row probeID Sequence
## probeFilter names(2): probeID Sequence
## probeTrim: 1 36</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#pbmdesign">PBMDesign</a></li>
      <li><a href="#pbmexperiment">PBMExperiment</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.pkimes.com">Patrick Kimes</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
